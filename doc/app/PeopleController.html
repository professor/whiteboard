<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type">

<title>Class: PeopleController</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>app/controllers/people_controller.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link"><a href="ApplicationController.html">ApplicationController</a>
  
</nav>

    <!-- Included Modules -->
<nav id="includes-section" class="section">
  <h3 class="section-header">Included Modules</h3>

  <ul class="link-list">
  
  
    <li><span class="include">ActionView::Helpers::AssetTagHelper</span>
  
  
  </ul>
</nav>

    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-i-advanced">#advanced</a>
    
    <li><a href="#method-i-class_profile">#class_profile</a>
    
    <li><a href="#method-i-create">#create</a>
    
    <li><a href="#method-i-destroy">#destroy</a>
    
    <li><a href="#method-i-edit">#edit</a>
    
    <li><a href="#method-i-index">#index</a>
    
    <li><a href="#method-i-index_autocomplete">#index_autocomplete</a>
    
    <li><a href="#method-i-my_courses">#my_courses</a>
    
    <li><a href="#method-i-my_courses_verbose">#my_courses_verbose</a>
    
    <li><a href="#method-i-my_teams">#my_teams</a>
    
    <li><a href="#method-i-new">#new</a>
    
    <li><a href="#method-i-photo_book">#photo_book</a>
    
    <li><a href="#method-i-revert_to_version">#revert_to_version</a>
    
    <li><a href="#method-i-robots">#robots</a>
    
    <li><a href="#method-i-show">#show</a>
    
    <li><a href="#method-i-show_by_twiki">#show_by_twiki</a>
    
    <li><a href="#method-i-update">#update</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    <nav id="fileindex-section" class="section project-section">
  <h3 class="section-header">Pages</h3>

  <ul>
  
    <li class="file"><a href="./doc/README_FOR_APP.html">README_FOR_APP</a>
  
  </ul>
</nav>

    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./GAppsProvisioning.html">GAppsProvisioning</a>
  
    <li><a href="./GAppsProvisioning/Connection.html">GAppsProvisioning::Connection</a>
  
    <li><a href="./GAppsProvisioning/GDataError.html">GAppsProvisioning::GDataError</a>
  
    <li><a href="./GAppsProvisioning/GroupEntry.html">GAppsProvisioning::GroupEntry</a>
  
    <li><a href="./GAppsProvisioning/MemberEntry.html">GAppsProvisioning::MemberEntry</a>
  
    <li><a href="./GAppsProvisioning/NicknameEntry.html">GAppsProvisioning::NicknameEntry</a>
  
    <li><a href="./GAppsProvisioning/OwnerEntry.html">GAppsProvisioning::OwnerEntry</a>
  
    <li><a href="./GAppsProvisioning/ProvisioningApi.html">GAppsProvisioning::ProvisioningApi</a>
  
    <li><a href="./GAppsProvisioning/UserEntry.html">GAppsProvisioning::UserEntry</a>
  
    <li><a href="./EffortReportsController.html">EffortReportsController</a>
  
    <li><a href="./EffortReportsController/PanelState.html">EffortReportsController::PanelState</a>
  
    <li><a href="./EffortReportsController/SemesterPanel.html">EffortReportsController::SemesterPanel</a>
  
    <li><a href="./TimeMachine.html">TimeMachine</a>
  
    <li><a href="./TimeMachine/Date.html">TimeMachine::Date</a>
  
    <li><a href="./TimeMachine/Time.html">TimeMachine::Time</a>
  
    <li><a href="./PeopleController.html">PeopleController</a>
  
    <li><a href="./PeopleController/ClassProfileState.html">PeopleController::ClassProfileState</a>
  
    <li><a href="./Rails.html">Rails</a>
  
    <li><a href="./Rails/GemDependency.html">Rails::GemDependency</a>
  
    <li><a href="./Users.html">Users</a>
  
    <li><a href="./Users/OmniauthCallbacksController.html">Users::OmniauthCallbacksController</a>
  
    <li><a href="./Ability.html">Ability</a>
  
    <li><a href="./AcademicCalendar.html">AcademicCalendar</a>
  
    <li><a href="./ApplicationController.html">ApplicationController</a>
  
    <li><a href="./ApplicationHelper.html">ApplicationHelper</a>
  
    <li><a href="./Course.html">Course</a>
  
    <li><a href="./CourseMailer.html">CourseMailer</a>
  
    <li><a href="./CourseNavigationsController.html">CourseNavigationsController</a>
  
    <li><a href="./CourseNumber.html">CourseNumber</a>
  
    <li><a href="./CourseNumbersController.html">CourseNumbersController</a>
  
    <li><a href="./CourseNumbersHelper.html">CourseNumbersHelper</a>
  
    <li><a href="./CoursesController.html">CoursesController</a>
  
    <li><a href="./CoursesHelper.html">CoursesHelper</a>
  
    <li><a href="./DelayedSystemJob.html">DelayedSystemJob</a>
  
    <li><a href="./DelayedSystemJobsController.html">DelayedSystemJobsController</a>
  
    <li><a href="./Deliverable.html">Deliverable</a>
  
    <li><a href="./DeliverableAttachment.html">DeliverableAttachment</a>
  
    <li><a href="./DeliverablesController.html">DeliverablesController</a>
  
    <li><a href="./DeliverablesHelper.html">DeliverablesHelper</a>
  
    <li><a href="./EffortLog.html">EffortLog</a>
  
    <li><a href="./EffortLogLineItem.html">EffortLogLineItem</a>
  
    <li><a href="./EffortLogLineItemsController.html">EffortLogLineItemsController</a>
  
    <li><a href="./EffortLogLineItemsHelper.html">EffortLogLineItemsHelper</a>
  
    <li><a href="./EffortLogMailer.html">EffortLogMailer</a>
  
    <li><a href="./EffortLogsController.html">EffortLogsController</a>
  
    <li><a href="./EffortLogsHelper.html">EffortLogsHelper</a>
  
    <li><a href="./FacultyAssignment.html">FacultyAssignment</a>
  
    <li><a href="./Gem.html">Gem</a>
  
    <li><a href="./GenericAjaxController.html">GenericAjaxController</a>
  
    <li><a href="./GenericMailer.html">GenericMailer</a>
  
    <li><a href="./GoogleMailingListJob.html">GoogleMailingListJob</a>
  
    <li><a href="./HUBClassRosterHandler.html">HUBClassRosterHandler</a>
  
    <li><a href="./IndexTank.html">IndexTank</a>
  
    <li><a href="./MailingListsController.html">MailingListsController</a>
  
    <li><a href="./Object.html">Object</a>
  
    <li><a href="./Page.html">Page</a>
  
    <li><a href="./PageAttachment.html">PageAttachment</a>
  
    <li><a href="./PageAttachmentsController.html">PageAttachmentsController</a>
  
    <li><a href="./PageComment.html">PageComment</a>
  
    <li><a href="./PageCommentMailer.html">PageCommentMailer</a>
  
    <li><a href="./PageCommentType.html">PageCommentType</a>
  
    <li><a href="./PageCommentTypesController.html">PageCommentTypesController</a>
  
    <li><a href="./PageCommentTypesHelper.html">PageCommentTypesHelper</a>
  
    <li><a href="./PageCommentsHelper.html">PageCommentsHelper</a>
  
    <li><a href="./PagesController.html">PagesController</a>
  
    <li><a href="./PagesHelper.html">PagesHelper</a>
  
    <li><a href="./PeerEvaluationController.html">PeerEvaluationController</a>
  
    <li><a href="./PeerEvaluationLearningObjective.html">PeerEvaluationLearningObjective</a>
  
    <li><a href="./PeerEvaluationReport.html">PeerEvaluationReport</a>
  
    <li><a href="./PeerEvaluationReview.html">PeerEvaluationReview</a>
  
    <li><a href="./PeopleHelper.html">PeopleHelper</a>
  
    <li><a href="./Person.html">Person</a>
  
    <li><a href="./PersonJob.html">PersonJob</a>
  
    <li><a href="./PersonMailer.html">PersonMailer</a>
  
    <li><a href="./Presentation.html">Presentation</a>
  
    <li><a href="./PresentationFeedback.html">PresentationFeedback</a>
  
    <li><a href="./PresentationFeedbackAnswer.html">PresentationFeedbackAnswer</a>
  
    <li><a href="./PresentationQuestion.html">PresentationQuestion</a>
  
    <li><a href="./PresentationsController.html">PresentationsController</a>
  
    <li><a href="./PresentationsHelper.html">PresentationsHelper</a>
  
    <li><a href="./RegisteredCourse.html">RegisteredCourse</a>
  
    <li><a href="./Registration.html">Registration</a>
  
    <li><a href="./RssFeed.html">RssFeed</a>
  
    <li><a href="./RssFeedsController.html">RssFeedsController</a>
  
    <li><a href="./RssFeedsHelper.html">RssFeedsHelper</a>
  
    <li><a href="./ScottyDogSaying.html">ScottyDogSaying</a>
  
    <li><a href="./ScottyDogSayingsController.html">ScottyDogSayingsController</a>
  
    <li><a href="./ScottyDogSayingsHelper.html">ScottyDogSayingsHelper</a>
  
    <li><a href="./SearchController.html">SearchController</a>
  
    <li><a href="./SponsoredProject.html">SponsoredProject</a>
  
    <li><a href="./SponsoredProjectAllocation.html">SponsoredProjectAllocation</a>
  
    <li><a href="./SponsoredProjectAllocationsController.html">SponsoredProjectAllocationsController</a>
  
    <li><a href="./SponsoredProjectEffort.html">SponsoredProjectEffort</a>
  
    <li><a href="./SponsoredProjectEffortMailer.html">SponsoredProjectEffortMailer</a>
  
    <li><a href="./SponsoredProjectEffortsController.html">SponsoredProjectEffortsController</a>
  
    <li><a href="./SponsoredProjectSponsor.html">SponsoredProjectSponsor</a>
  
    <li><a href="./SponsoredProjectSponsorsController.html">SponsoredProjectSponsorsController</a>
  
    <li><a href="./SponsoredProjectsController.html">SponsoredProjectsController</a>
  
    <li><a href="./StaticController.html">StaticController</a>
  
    <li><a href="./StrengthTheme.html">StrengthTheme</a>
  
    <li><a href="./Suggestion.html">Suggestion</a>
  
    <li><a href="./SuggestionsController.html">SuggestionsController</a>
  
    <li><a href="./SystemController.html">SystemController</a>
  
    <li><a href="./SystemHelper.html">SystemHelper</a>
  
    <li><a href="./TaskType.html">TaskType</a>
  
    <li><a href="./TaskTypesController.html">TaskTypesController</a>
  
    <li><a href="./TaskTypesHelper.html">TaskTypesHelper</a>
  
    <li><a href="./Team.html">Team</a>
  
    <li><a href="./TeamAssignment.html">TeamAssignment</a>
  
    <li><a href="./TeamsController.html">TeamsController</a>
  
    <li><a href="./TeamsHelper.html">TeamsHelper</a>
  
    <li><a href="./TmpUpdateFacultyAssignments.html">TmpUpdateFacultyAssignments</a>
  
    <li><a href="./User.html">User</a>
  
    <li><a href="./UserPreference.html">UserPreference</a>
  
    <li><a href="./UsersHelper.html">UsersHelper</a>
  
    <li><a href="./WelcomeController.html">WelcomeController</a>
  
    <li><a href="./WelcomeHelper.html">WelcomeHelper</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class PeopleController</h1>

  <div id="description" class="description">
    
  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-advanced" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">advanced</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="advanced-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 46</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">advanced</span>
  <span class="ruby-identifier">index</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- advanced-source -->
          
        </div>

        

        
      </div><!-- advanced-method -->

    
      <div id="method-i-class_profile" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">class_profile</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="class_profile-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 349</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">class_profile</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:class_profile_state</span>]
    <span class="ruby-ivar">@class_profile_state</span> = <span class="ruby-constant">ClassProfileState</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-ivar">@class_profile_state</span>.<span class="ruby-identifier">program</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:class_profile_state</span>][<span class="ruby-value">:program</span>]
    <span class="ruby-ivar">@class_profile_state</span>.<span class="ruby-identifier">graduation_year</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:class_profile_state</span>][<span class="ruby-value">:graduation_year</span>]
    <span class="ruby-ivar">@class_profile_state</span>.<span class="ruby-identifier">is_part_time</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:class_profile_state</span>][<span class="ruby-value">:is_part_time</span>]
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@class_profile_state</span> = <span class="ruby-constant">ClassProfileState</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-ivar">@class_profile_state</span>.<span class="ruby-identifier">program</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_student</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">masters_program</span> <span class="ruby-operator">:</span> <span class="ruby-string">&quot;SE&quot;</span>
    <span class="ruby-ivar">@class_profile_state</span>.<span class="ruby-identifier">graduation_year</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>.<span class="ruby-identifier">year</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
    <span class="ruby-ivar">@class_profile_state</span>.<span class="ruby-identifier">is_part_time</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_student</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_part_time</span> <span class="ruby-operator">?</span> <span class="ruby-string">&quot;FT&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-string">&quot;PT&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@class_profile_state</span>.<span class="ruby-identifier">is_part_time</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;PT&quot;</span>
      <span class="ruby-ivar">@students</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">part_time_class_of</span>(<span class="ruby-ivar">@class_profile_state</span>.<span class="ruby-identifier">program</span>, <span class="ruby-ivar">@class_profile_state</span>.<span class="ruby-identifier">graduation_year</span>.<span class="ruby-identifier">to_s</span>)
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;FT&quot;</span>
      <span class="ruby-ivar">@students</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">full_time_class_of</span>(<span class="ruby-ivar">@class_profile_state</span>.<span class="ruby-identifier">program</span>, <span class="ruby-ivar">@class_profile_state</span>.<span class="ruby-identifier">graduation_year</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@programs</span> = []
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">execute</span>(<span class="ruby-string">&quot;SELECT distinct masters_program FROM users u;&quot;</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">result</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@programs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">result</span>[<span class="ruby-string">&quot;masters_program&quot;</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@tracks</span> = []
  <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">execute</span>(<span class="ruby-string">&quot;SELECT distinct masters_track FROM users u;&quot;</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">result</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@tracks</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">result</span>[<span class="ruby-string">&quot;masters_track&quot;</span>]
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@title</span> = <span class="ruby-node">&quot;Class profile for #{@class_profile_state.is_part_time} #{@class_profile_state.program} #{@class_profile_state.graduation_year}&quot;</span>

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:layout</span>]
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span> } <span class="ruby-comment"># index.html.erb</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;cmu_sv&quot;</span> } <span class="ruby-comment"># index.html.erb</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- class_profile-source -->
          
        </div>

        

        
      </div><!-- class_profile-method -->

    
      <div id="method-i-create" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">create</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>POST /people POST /people.xml</p>
          

          
          <div class="method-source-code" id="create-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 180</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">create</span>
    <span class="ruby-identifier">authorize!</span> <span class="ruby-value">:create</span>, <span class="ruby-constant">User</span>

    <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>])
    <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">updated_by_user_id</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">id</span>
    <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">image_uri</span> = <span class="ruby-string">&quot;/images/mascot.jpg&quot;</span>
    <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">biography</span> = <span class="ruby-string">&quot;&lt;p&gt;I was raised by sheepherders on the hills of BoingBoing while they were selling chunky bacon. Because I have a ring, I need help with putting on my clothes. After working hard they promoted me to garbage man. They told me the reason for this new responsibility was show me the money. I looked for a treasure map and tools, but I never did find the fourteen minutes. People's trash clearly isn't multitudinous. I hope to put my real biography here one day.&lt;/p&gt;&quot;</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">is_student</span>
      <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">user_text</span> = <span class="ruby-string">&quot;&lt;h2&gt;About Me&lt;/h2&gt;&lt;p&gt;I'd like to accomplish the following three goals (professional or personal) by the time I graduate:&lt;ol&gt;&lt;li&gt;Goal 1&lt;/li&gt;&lt;li&gt;Goal 2&lt;/li&gt;&lt;li&gt;Goal 3&lt;/li&gt;&lt;/ol&gt;&lt;/p&gt;&quot;</span>
    <span class="ruby-keyword">end</span>


    <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>

<span class="ruby-comment">#      error_message = &quot;&quot;</span>
<span class="ruby-comment">#      if params[:create_google_email]</span>
<span class="ruby-comment">#         password = 'just4now' + Time.now.to_f.to_s[-4,4] # just4now0428</span>
<span class="ruby-comment">#         status = @person.create_google_email(password)</span>
<span class="ruby-comment">#         if status.is_a?(String)</span>
<span class="ruby-comment">#           error_message += &quot;Google account not created. &quot; + status + &quot;&lt;/br&gt;&lt;/br&gt;&quot;</span>
<span class="ruby-comment">#         else</span>
<span class="ruby-comment">#          send_email([@person.personal_email, @person.email], @person.email, generate_message(@person, password))</span>
<span class="ruby-comment">#         end</span>
<span class="ruby-comment">#      end</span>
<span class="ruby-comment">#      if params[:create_twiki_account]</span>
<span class="ruby-comment">#        status = @person.create_twiki_account</span>
<span class="ruby-comment">#        error_message +=  'TWiki account was not created.&lt;br/&gt;&lt;/br&gt;' unless status</span>
<span class="ruby-comment">#        status = @person.reset_twiki_password</span>
<span class="ruby-comment">#        error_message +=  'TWiki account password was not reset.&lt;/br&gt;' unless status</span>
<span class="ruby-comment">#      end</span>

      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">save</span>
        <span class="ruby-identifier">create_google_email</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:create_google_email</span>]
        <span class="ruby-identifier">create_twiki_account</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:create_twiki_account</span>]
        <span class="ruby-identifier">create_yammer_account</span> = <span class="ruby-keyword">false</span> <span class="ruby-comment">#params[:create_yammer_account]</span>
        <span class="ruby-constant">Delayed</span><span class="ruby-operator">::</span><span class="ruby-constant">Job</span>.<span class="ruby-identifier">enqueue</span>(<span class="ruby-constant">PersonJob</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@person</span>.<span class="ruby-identifier">id</span>, <span class="ruby-identifier">params</span>[<span class="ruby-value">:create_google_email</span>], <span class="ruby-identifier">params</span>[<span class="ruby-value">:create_twiki_account</span>], <span class="ruby-identifier">params</span>[<span class="ruby-value">:create_yammer_account</span>])) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:create_google_email</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:create_twiki_account</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:create_yammer_account</span>].<span class="ruby-identifier">nil?</span>
                                      <span class="ruby-comment">#          job = PersonJob.new(@person.id, params[:create_google_email], params[:create_twiki_account]) unless params[:create_google_email].nil? &amp;&amp;  params[:create_twiki_account].nil?</span>
                                      <span class="ruby-comment">#          job.perform</span>

                                      <span class="ruby-comment">#        flash[:error] = error_message unless error_message.blank?</span>

        <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-string">'Person was successfully created.'</span>
        <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-ivar">@person</span>) }
        <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span>, <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:created</span>, <span class="ruby-value">:location</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span> }
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;new&quot;</span> }
        <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">errors</span>, <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:unprocessable_entity</span> }
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span></pre>
          </div><!-- create-source -->
          
        </div>

        

        
      </div><!-- create-method -->

    
      <div id="method-i-destroy" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">destroy</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>DELETE /people/1 DELETE /people/1.xml</p>
          

          
          <div class="method-source-code" id="destroy-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 269</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">destroy</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_admin?</span>
    <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-string">'You don'</span> <span class="ruby-string">'t have permission to do this action.'</span>
    <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">people_url</span>) <span class="ruby-keyword">and</span> <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
  <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">destroy</span>

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">people_url</span>) }
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span> { <span class="ruby-identifier">head</span> <span class="ruby-value">:ok</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- destroy-source -->
          
        </div>

        

        
      </div><!-- destroy-method -->

    
      <div id="method-i-edit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">edit</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>GET /people/1/edit</p>
          

          
          <div class="method-source-code" id="edit-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 171</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">edit</span>
    <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
<span class="ruby-comment">#    authorize! :update, @person</span>

    <span class="ruby-ivar">@strength_themes</span> = <span class="ruby-constant">StrengthTheme</span>.<span class="ruby-identifier">all</span>
  <span class="ruby-keyword">end</span></pre>
          </div><!-- edit-source -->
          
        </div>

        

        
      </div><!-- edit-method -->

    
      <div id="method-i-index" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">index</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>GET /people GET /people.xml</p>
          

          
          <div class="method-source-code" id="index-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 21</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">index</span>
  <span class="ruby-ivar">@people</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:is_active</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>).<span class="ruby-identifier">order</span>(<span class="ruby-string">&quot;first_name ASC, last_name ASC&quot;</span>).<span class="ruby-identifier">all</span>

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@people</span> }
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">json</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:json</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@people</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">person</span><span class="ruby-operator">|</span> <span class="ruby-constant">Hash</span>[<span class="ruby-string">&quot;id&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">twiki_name</span>,
                                                                  <span class="ruby-string">&quot;first_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">first_name</span>,
                                                                  <span class="ruby-string">&quot;last_name&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">last_name</span>,
                                                                  <span class="ruby-string">&quot;image_uri&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">image_uri</span>,
                                                                  <span class="ruby-string">&quot;email&quot;</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">email</span>].<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">person</span>.<span class="ruby-identifier">telephones_hash</span>) }, <span class="ruby-value">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- index-source -->
          
        </div>

        

        
      </div><!-- index-method -->

    
      <div id="method-i-index_autocomplete" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">index_autocomplete</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Ajax call for autocomplete using <a href="http://:term">params</a></p>
          

          
          <div class="method-source-code" id="index_autocomplete-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 35</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">index_autocomplete</span>
  <span class="ruby-comment">#if database is mysql</span>
  <span class="ruby-comment">#@people = User.where(&quot;human_name LIKE ?&quot;, &quot;%#{params[:term]}%&quot;).all</span>
  <span class="ruby-ivar">@people</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">where</span>(<span class="ruby-string">&quot;human_name ILIKE ?&quot;</span>, <span class="ruby-node">&quot;%#{params[:term]}%&quot;</span>).<span class="ruby-identifier">all</span>

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@people</span> }
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">json</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:json</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@people</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">person</span><span class="ruby-operator">|</span> <span class="ruby-identifier">person</span>.<span class="ruby-identifier">human_name</span> }, <span class="ruby-value">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- index_autocomplete-source -->
          
        </div>

        

        
      </div><!-- index_autocomplete-method -->

    
      <div id="method-i-my_courses" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">my_courses</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="my_courses-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 312</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">my_courses</span>
  <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-node">&quot;Person with an id of #{params[:id]} is not in this system.&quot;</span>
    <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">people_url</span>) <span class="ruby-keyword">and</span> <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">person_id</span> = <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">person_id</span>)
    <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_staff?</span>)<span class="ruby-operator">||</span>(<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_admin?</span>)
      <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-string">'You don'</span> <span class="ruby-string">'t have permission to see another person'</span> <span class="ruby-string">'s courses.'</span>
      <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">people_url</span>) <span class="ruby-keyword">and</span> <span class="ruby-keyword">return</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@registered_for_these_courses</span> = [] <span class="ruby-comment">#@person.registered_for_these_courses</span>
  <span class="ruby-ivar">@teaching_these_courses</span> = <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">teaching_these_courses</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- my_courses-source -->
          
        </div>

        

        
      </div><!-- my_courses-method -->

    
      <div id="method-i-my_courses_verbose" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">my_courses_verbose</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="my_courses_verbose-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 330</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">my_courses_verbose</span>
  <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
  <span class="ruby-identifier">person_id</span> = <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">person_id</span>)
    <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_staff?</span>)<span class="ruby-operator">||</span>(<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_admin?</span>)
      <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-string">'You don'</span> <span class="ruby-string">'t have permission to see another person'</span> <span class="ruby-string">'s courses.'</span>
      <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">people_url</span>) <span class="ruby-keyword">and</span> <span class="ruby-keyword">return</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@courses_registered_as_student</span> = <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">registered_for_these_courses_during_current_semester</span>
  <span class="ruby-ivar">@courses_teaching_as_faculty</span> = <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">teaching_these_courses</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- my_courses_verbose-source -->
          
        </div>

        

        
      </div><!-- my_courses_verbose-method -->

    
      <div id="method-i-my_teams" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">my_teams</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="my_teams-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 285</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">my_teams</span>
  <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-node">&quot;Person with an id of #{params[:id]} is not in this system.&quot;</span>
    <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">people_url</span>) <span class="ruby-keyword">and</span> <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">person_id</span> = <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">person_id</span>)
    <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_staff?</span>)<span class="ruby-operator">||</span>(<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_admin?</span>)
      <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-string">'You don'</span> <span class="ruby-string">'t have permission to see another person'</span> <span class="ruby-string">'s teams.'</span>
      <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">people_url</span>) <span class="ruby-keyword">and</span> <span class="ruby-keyword">return</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@course</span> = <span class="ruby-constant">Course</span>.<span class="ruby-identifier">new</span>()

  <span class="ruby-ivar">@current_year</span> = <span class="ruby-constant">Date</span>.<span class="ruby-identifier">today</span>.<span class="ruby-identifier">year</span>()
  <span class="ruby-ivar">@current_semester</span> = <span class="ruby-constant">AcademicCalendar</span>.<span class="ruby-identifier">current_semester</span>()

  <span class="ruby-comment">#SQL statements determined by Team Juran</span>
  <span class="ruby-ivar">@current_teams_as_member</span> = <span class="ruby-constant">Team</span>.<span class="ruby-identifier">find_current_by_person</span>(<span class="ruby-ivar">@person</span>)
  <span class="ruby-ivar">@past_teams_as_member</span> = <span class="ruby-constant">Team</span>.<span class="ruby-identifier">find_past_by_person</span>(<span class="ruby-ivar">@person</span>)

  (<span class="ruby-ivar">@teams_map</span>, <span class="ruby-ivar">@teams_students_map</span>) = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">faculty_teams_map</span>(<span class="ruby-identifier">person_id</span>)
  <span class="ruby-identifier">a</span> = <span class="ruby-value">10</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- my_teams-source -->
          
        </div>

        

        
      </div><!-- my_teams-method -->

    
      <div id="method-i-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>GET /people/new GET /people/new.xml</p>
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 142</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">new</span>
  <span class="ruby-identifier">authorize!</span> <span class="ruby-value">:create</span>, <span class="ruby-constant">User</span>

  <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">is_active</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">webiso_account</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:webiso_account</span>]
  <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">personal_email</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:personal_email</span>]
  <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">is_student</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:is_student</span>]
  <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">first_name</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:first_name</span>]
  <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">last_name</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:last_name</span>]
  <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">masters_program</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:program</span>]
  <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">expires_at</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:expires_at</span>]

  <span class="ruby-keyword">if</span> <span class="ruby-constant">Rails</span>.<span class="ruby-identifier">env</span>.<span class="ruby-identifier">development?</span>
    <span class="ruby-ivar">@domain</span> = <span class="ruby-constant">GOOGLE_DOMAIN</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@domain</span> = <span class="ruby-string">&quot;sv.cmu.edu&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@strength_themes</span> = <span class="ruby-constant">StrengthTheme</span>.<span class="ruby-identifier">all</span>


  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-comment"># new.html.erb</span>
    <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span> }
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- new-source -->
          
        </div>

        

        
      </div><!-- new-method -->

    
      <div id="method-i-photo_book" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">photo_book</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="photo_book-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 50</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">photo_book</span>
  <span class="ruby-identifier">index</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- photo_book-source -->
          
        </div>

        

        
      </div><!-- photo_book-method -->

    
      <div id="method-i-revert_to_version" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">revert_to_version</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="revert_to_version-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 256</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">revert_to_version</span>
  <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
  <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">revert_to!</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:version_id</span>]
  <span class="ruby-identifier">redirect_to</span> <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'show'</span>, <span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- revert_to_version-source -->
          
        </div>

        

        
      </div><!-- revert_to_version-method -->

    
      <div id="method-i-robots" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">robots</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="robots-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 262</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">robots</span>
  <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">info</span>(<span class="ruby-string">&quot;curriculum comment: robot detected&quot;</span>)
  <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-comment"># index.html.erb</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- robots-source -->
          
        </div>

        

        
      </div><!-- robots-method -->

    
      <div id="method-i-show" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">show</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>GET /people/1 GET /people/1.xml GET /people/AndrewCarnegie GET
/people/AndrewCarnegie.xml</p>
          

          
          <div class="method-source-code" id="show-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 59</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">show</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>) <span class="ruby-comment">#This is a string</span>
    <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_by_twiki_name</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
  <span class="ruby-keyword">else</span> <span class="ruby-comment">#This is a number</span>
    <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">revert_to</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:version_id</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">params</span>[<span class="ruby-value">:version_id</span>]

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-node">&quot;Person with an id of #{params[:id]} is not in this system.&quot;</span>
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">people_url</span>) }
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">errors</span>, <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:unprocessable_entity</span> }
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> <span class="ruby-comment"># show.html.erb</span>
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span> }
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">json</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:json</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span>, <span class="ruby-value">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span> }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- show-source -->
          
        </div>

        

        
      </div><!-- show-method -->

    
      <div id="method-i-show_by_twiki" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">show_by_twiki</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>GET /people/twiki/AndrewCarnegie GET /people/twiki/AndrewCarnegie.xml</p>
          

          
          <div class="method-source-code" id="show_by_twiki-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 82</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">show_by_twiki</span>

  <span class="ruby-identifier">redirect_to</span> <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'robots'</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">robot?</span>
  <span class="ruby-identifier">host</span> = <span class="ruby-identifier">get_http_host</span>()
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">host</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;info.sv.cmu.edu&quot;</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">host</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;info.west.cmu.edu&quot;</span>)) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">nil?</span>)
    <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-string">&quot;You don't have permissions to view this data.&quot;</span>
    <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">people_url</span>)
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@machine_name</span> = <span class="ruby-string">&quot;http://whiteboard.sv.cmu.edu&quot;</span>

  <span class="ruby-identifier">twiki_name</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:twiki_name</span>]
  <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find_by_twiki_name</span>(<span class="ruby-identifier">twiki_name</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span>
    <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">twiki_name</span> = <span class="ruby-identifier">twiki_name</span>
    <span class="ruby-identifier">names</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">parse_twiki</span>(<span class="ruby-identifier">twiki_name</span>)
    <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">first_name</span> = <span class="ruby-identifier">names</span>[<span class="ruby-value">0</span>] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">names</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">last_name</span> = <span class="ruby-identifier">names</span>[<span class="ruby-value">1</span>] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">names</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">webiso_account</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_f</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-comment">#This line probably not necessary since I added it to User.before_validation</span>
    <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">is_active</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">updated_by_user_id</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">id</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_user</span>
    <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">image_uri</span> = <span class="ruby-string">&quot;/images/mascot.jpg&quot;</span>
    <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">local_near_remote</span> = <span class="ruby-string">&quot;Unknown&quot;</span>

    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@person</span>.<span class="ruby-identifier">save</span>
      <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-string">'User could not be saved.'</span>
        <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">people_url</span>) <span class="ruby-keyword">and</span> <span class="ruby-keyword">return</span> }
        <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">errors</span>, <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:unprocessable_entity</span> <span class="ruby-keyword">and</span> <span class="ruby-keyword">return</span> }
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">options</span> = {<span class="ruby-value">:to</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;help@sv.cmu.edu&quot;</span>, <span class="ruby-value">:cc</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;todd.sedano@sv.cmu.edu&quot;</span>,
               <span class="ruby-value">:subject</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;rails user account automatically created for #{twiki_name}&quot;</span>,
               <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-node">&quot;Action Required: update this user's andrew id in the rails database.&lt;br/&gt;&lt;br/&gt;The twiki page for #{twiki_name} was rendered on the twiki server. This page asked rails to generate user data from the rails database. This user did not exist in the rails database, so rails created it.&lt;br/&gt;Note: this person can not edit their own information until their record is updated with their andrew login.&lt;br/&gt;&lt;br/&gt;first_name: #{@person.first_name}&lt;br/&gt;last_name: #{@person.last_name}&lt;br/&gt;email: #{@person.email}&lt;br/&gt;is_active?: #{@person.is_active?}&quot;</span>,
               <span class="ruby-value">:url_label</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Edit this person's information&quot;</span>,
               <span class="ruby-value">:url</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;http://whiteboard.sv.cmu.edu&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">edit_person_path</span>(<span class="ruby-ivar">@person</span>)
    }
    <span class="ruby-constant">GenericMailer</span>.<span class="ruby-identifier">email</span>(<span class="ruby-identifier">options</span>).<span class="ruby-identifier">deliver</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">flash</span>[<span class="ruby-value">:error</span>] = <span class="ruby-node">&quot;Person #{params[:twiki_name]} is not in this system.&quot;</span>
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-identifier">people_url</span>) }
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">errors</span>, <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:unprocessable_entity</span> }
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:html</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span>, <span class="ruby-value">:layout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">false</span> } <span class="ruby-comment"># show.html.erb</span>
      <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span> }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- show_by_twiki-source -->
          
        </div>

        

        
      </div><!-- show_by_twiki-method -->

    
      <div id="method-i-update" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">update</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>PUT /people/1 PUT /people/1.xml</p>
          

          
          <div class="method-source-code" id="update-source">
            <pre><span class="ruby-comment"># File app/controllers/people_controller.rb, line 233</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">update</span>
    <span class="ruby-ivar">@person</span> = <span class="ruby-constant">User</span>.<span class="ruby-identifier">find</span>(<span class="ruby-identifier">params</span>[<span class="ruby-value">:id</span>])
<span class="ruby-comment">#    authorize! :update, @person</span>

    <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">updated_by_user_id</span> = <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">id</span>
    <span class="ruby-ivar">@strength_themes</span> = <span class="ruby-constant">StrengthTheme</span>.<span class="ruby-identifier">all</span>

    <span class="ruby-identifier">respond_to</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">format</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">attributes</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>]
      <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">photo</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>][<span class="ruby-value">:photo</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">can?</span> <span class="ruby-value">:upload_photo</span>, <span class="ruby-constant">User</span>
      <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">expires_at</span> = <span class="ruby-identifier">params</span>[<span class="ruby-value">:user</span>][<span class="ruby-value">:expires_at</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_admin?</span>

      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">save</span>
        <span class="ruby-identifier">flash</span>[<span class="ruby-value">:notice</span>] = <span class="ruby-string">'Person was successfully updated.'</span>
        <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">redirect_to</span>(<span class="ruby-ivar">@person</span>) }
        <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span> { <span class="ruby-identifier">head</span> <span class="ruby-value">:ok</span> }
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">format</span>.<span class="ruby-identifier">html</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:action</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;edit&quot;</span> }
        <span class="ruby-identifier">format</span>.<span class="ruby-identifier">xml</span> { <span class="ruby-identifier">render</span> <span class="ruby-value">:xml</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@person</span>.<span class="ruby-identifier">errors</span>, <span class="ruby-value">:status</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:unprocessable_entity</span> }
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span></pre>
          </div><!-- update-source -->
          
        </div>

        

        
      </div><!-- update-method -->

    
    </section><!-- public-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.10.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

