<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>Class: Deliverable</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>app/models/deliverable.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">ActiveRecord::Base
  
</nav>

    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-filter">::filter</a>
    
    <li><a href="#method-c-find_by_user_and_teams">::find_by_user_and_teams</a>
    
    <li><a href="#method-c-find_current_by_user">::find_current_by_user</a>
    
    <li><a href="#method-c-find_past_by_user">::find_past_by_user</a>
    
    <li><a href="#method-i-course">#course</a>
    
    <li><a href="#method-i-course_id">#course_id</a>
    
    <li><a href="#method-i-current_attachment">#current_attachment</a>
    
    <li><a href="#method-i-editable-3F">#editable?</a>
    
    <li><a href="#method-i-has_feedback-3F">#has_feedback?</a>
    
    <li><a href="#method-i-is_team_deliverable-3F">#is_team_deliverable?</a>
    
    <li><a href="#method-i-owner_email">#owner_email</a>
    
    <li><a href="#method-i-owner_name">#owner_name</a>
    
    <li><a href="#method-i-populate_status">#populate_status</a>
    
    <li><a href="#method-i-sanitize_data">#sanitize_data</a>
    
    <li><a href="#method-i-send_deliverable_feedback_email">#send_deliverable_feedback_email</a>
    
    <li><a href="#method-i-send_deliverable_upload_email">#send_deliverable_upload_email</a>
    
    <li><a href="#method-i-task_number">#task_number</a>
    
    <li><a href="#method-i-unique_course_task_owner-3F">#unique_course_task_owner?</a>
    
    <li><a href="#method-i-update_team">#update_team</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    
    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./Ability.html">Ability</a>
  
    <li><a href="./AcademicCalendar.html">AcademicCalendar</a>
  
    <li><a href="./Assignment.html">Assignment</a>
  
    <li><a href="./Course.html">Course</a>
  
    <li><a href="./CourseNumber.html">CourseNumber</a>
  
    <li><a href="./DelayedSystemJob.html">DelayedSystemJob</a>
  
    <li><a href="./Deliverable.html">Deliverable</a>
  
    <li><a href="./DeliverableAttachment.html">DeliverableAttachment</a>
  
    <li><a href="./EffortLog.html">EffortLog</a>
  
    <li><a href="./EffortLogLineItem.html">EffortLogLineItem</a>
  
    <li><a href="./FacultyAssignment.html">FacultyAssignment</a>
  
    <li><a href="./GradingRange.html">GradingRange</a>
  
    <li><a href="./Page.html">Page</a>
  
    <li><a href="./PageAttachment.html">PageAttachment</a>
  
    <li><a href="./PageComment.html">PageComment</a>
  
    <li><a href="./PageCommentType.html">PageCommentType</a>
  
    <li><a href="./PeerEvaluationLearningObjective.html">PeerEvaluationLearningObjective</a>
  
    <li><a href="./PeerEvaluationReport.html">PeerEvaluationReport</a>
  
    <li><a href="./PeerEvaluationReview.html">PeerEvaluationReview</a>
  
    <li><a href="./Person.html">Person</a>
  
    <li><a href="./Presentation.html">Presentation</a>
  
    <li><a href="./PresentationFeedback.html">PresentationFeedback</a>
  
    <li><a href="./PresentationFeedbackAnswer.html">PresentationFeedbackAnswer</a>
  
    <li><a href="./PresentationQuestion.html">PresentationQuestion</a>
  
    <li><a href="./RegisteredCourse.html">RegisteredCourse</a>
  
    <li><a href="./Registration.html">Registration</a>
  
    <li><a href="./RssFeed.html">RssFeed</a>
  
    <li><a href="./ScottyDogSaying.html">ScottyDogSaying</a>
  
    <li><a href="./SponsoredProject.html">SponsoredProject</a>
  
    <li><a href="./SponsoredProjectAllocation.html">SponsoredProjectAllocation</a>
  
    <li><a href="./SponsoredProjectEffort.html">SponsoredProjectEffort</a>
  
    <li><a href="./SponsoredProjectSponsor.html">SponsoredProjectSponsor</a>
  
    <li><a href="./StrengthTheme.html">StrengthTheme</a>
  
    <li><a href="./Suggestion.html">Suggestion</a>
  
    <li><a href="./TaskType.html">TaskType</a>
  
    <li><a href="./Team.html">Team</a>
  
    <li><a href="./TeamAssignment.html">TeamAssignment</a>
  
    <li><a href="./User.html">User</a>
  
    <li><a href="./UserPreference.html">UserPreference</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class Deliverable</h1>

  <div id="description" class="description">
    
<p><a href="Deliverable.html">Deliverable</a> is a zip or a file that the
students submit for a course</p>

<p>There are two ways for a student team to upload their deliverables.</p>

<p>Way 1) On the curriculum pages for each task,  under the “Submitting Your
Work” tab, there is a “submit your deliverable link” – this gives the
student the ability to name their deliverable, and upload a single
attachment (i.e. one doc, ppt, or zip file) The student needs to mark
whether this is an individual deliverable or team deliverable. By default a
task number and the course number is provided for the student. If a faculty
member tries to do this, they won’t see any courses lists since they aren’t
taking the course as a student. Students can submit only team deliverable
and one individual deliverable per task, although they can update the
attachment as many times as they like.</p>

<p>Every member of a team can see team deliverables, only the individual can
see their individual deliverable.</p>

<p>Way 2) A student team can upload their deliverable by clicking on “My
Deliverables” on the left hand navigation and select “New” at the bottom of
the page. This is a little less efficient because the student needs to
select a course and assignment. It is a quick way for a student to see
everything they have submitted for their courses.</p>

<p>If a student or team accidentally uploads the wrong file, they can upload
additional files. All files are kept in the system, but the convention is
that the faculty will only examine the last uploaded file.</p>

<p>The faculty assigned to that team will receive an email whenever a student
submits a deliverable. The faculty can click on the email and provide
either written comments in an text area or provide a file attachment back.
If you annotate a word document you would upload the word document. If you
annotate multiple files then you would attach a zip, just like the students
do.</p>

<p>If the faculty needs to see who has provided feedback or if they loose the
email sent by the system, there is a f faculty interface for examining the
deliverables. It is not perfect, it was developed by the students and they
didn’t have a strong sense of how we would use it. It currently shows all
the deliverables submitted for a course sorted by recent changes first.
There is no way to filter by faculty member, or sort by task, or sort by
team, or sort by whether feedback has been provided. Control F in the
browser is a life saver. It does show you which deliverables have been
graded. In theory, just relying on the emails should be sufficient.</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-filter" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">filter</span><span
            class="method-args">(filter_params = {})</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="filter-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 126</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">filter_params</span> = {})
  <span class="ruby-identifier">semester</span>, <span class="ruby-identifier">year</span> = <span class="ruby-identifier">filter_params</span>[<span class="ruby-value">:semester_year</span>].<span class="ruby-identifier">split</span>(<span class="ruby-string">'-'</span>)
  <span class="ruby-identifier">filter_criteria</span> = {<span class="ruby-identifier">semester</span><span class="ruby-operator">:</span> <span class="ruby-identifier">semester</span>, <span class="ruby-identifier">year</span><span class="ruby-operator">:</span> <span class="ruby-identifier">year</span>, <span class="ruby-identifier">id</span><span class="ruby-operator">:</span> <span class="ruby-identifier">filter_params</span>[<span class="ruby-value">:course_id</span>]}
  <span class="ruby-identifier">courses</span> = <span class="ruby-constant">Course</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">filter_criteria</span>)

  <span class="ruby-identifier">deliverables</span> = []
  <span class="ruby-identifier">courses</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">course</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">assignments</span> =
      <span class="ruby-identifier">course</span>.<span class="ruby-identifier">assignments</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">assignment</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">filter_params</span>[<span class="ruby-value">:assignment_id</span>].<span class="ruby-identifier">blank?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">filter_params</span>[<span class="ruby-value">:assignment_id</span>].<span class="ruby-identifier">to_i</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">assignments</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">assignment</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">deliverables</span>.<span class="ruby-identifier">concat</span>(
        <span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">deliverables</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">deliverable</span><span class="ruby-operator">|</span>
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">filter_params</span>[<span class="ruby-value">:submitted_by</span>].<span class="ruby-identifier">blank?</span>
            <span class="ruby-identifier">filter_params</span>[<span class="ruby-value">:status</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">deliverable</span>.<span class="ruby-identifier">status</span>
          <span class="ruby-keyword">else</span>
            <span class="ruby-identifier">deliverable</span>.<span class="ruby-identifier">creator</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">filter_params</span>[<span class="ruby-value">:submitted_by</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">filter_params</span>[<span class="ruby-value">:status</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">deliverable</span>.<span class="ruby-identifier">status</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
      )
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">deliverables</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- filter-source -->
          
        </div>

        

        
      </div><!-- filter-method -->

    
      <div id="method-c-find_by_user_and_teams" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find_by_user_and_teams</span><span
            class="method-args">(user, teams)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="find_by_user_and_teams-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 116</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">find_by_user_and_teams</span>(<span class="ruby-identifier">user</span>, <span class="ruby-identifier">teams</span>)
  <span class="ruby-identifier">team_condition</span> = <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">teams</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-identifier">team_condition</span> = <span class="ruby-string">&quot;team_id IN (&quot;</span>
    <span class="ruby-identifier">team_condition</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">teams</span>.<span class="ruby-identifier">collect</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">id</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-string">','</span>)
    <span class="ruby-identifier">team_condition</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;) OR &quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-constant">Deliverable</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:all</span>, <span class="ruby-value">:conditions</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">team_condition</span> <span class="ruby-operator">+</span> <span class="ruby-node">&quot;(team_id IS NULL AND creator_id = #{user.id})&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- find_by_user_and_teams-source -->
          
        </div>

        

        
      </div><!-- find_by_user_and_teams-method -->

    
      <div id="method-c-find_current_by_user" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find_current_by_user</span><span
            class="method-args">(user)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="find_current_by_user-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 102</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">find_current_by_user</span>(<span class="ruby-identifier">user</span>)
  <span class="ruby-comment"># Find everything where the passed in person is either the creator</span>
  <span class="ruby-comment"># or is on the deliverable's team</span>
  <span class="ruby-identifier">current_teams</span> = <span class="ruby-constant">Team</span>.<span class="ruby-identifier">find_current_by_person</span>(<span class="ruby-identifier">user</span>)
  <span class="ruby-constant">Deliverable</span>.<span class="ruby-identifier">find_by_user_and_teams</span>(<span class="ruby-identifier">user</span>, <span class="ruby-identifier">current_teams</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- find_current_by_user-source -->
          
        </div>

        

        
      </div><!-- find_current_by_user-method -->

    
      <div id="method-c-find_past_by_user" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">find_past_by_user</span><span
            class="method-args">(user)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="find_past_by_user-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 109</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">find_past_by_user</span>(<span class="ruby-identifier">user</span>)
  <span class="ruby-comment"># Find everything where the passed in person is either the creator</span>
  <span class="ruby-comment"># or is on the deliverable's team</span>
  <span class="ruby-identifier">past_teams</span> = <span class="ruby-constant">Team</span>.<span class="ruby-identifier">find_past_by_person</span>(<span class="ruby-identifier">user</span>)
  <span class="ruby-constant">Deliverable</span>.<span class="ruby-identifier">find_by_user_and_teams</span>(<span class="ruby-identifier">user</span>, <span class="ruby-identifier">past_teams</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- find_past_by_user-source -->
          
        </div>

        

        
      </div><!-- find_past_by_user-method -->

    
    </section><!-- public-class-method-details -->
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Instance Methods</h3>

    
      <div id="method-i-course" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">course</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="course-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 53</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">course</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">course</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- course-source -->
          
        </div>

        

        
      </div><!-- course-method -->

    
      <div id="method-i-course_id" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">course_id</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="course_id-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 57</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">course_id</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">course_id</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- course_id-source -->
          
        </div>

        

        
      </div><!-- course_id-method -->

    
      <div id="method-i-current_attachment" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">current_attachment</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="current_attachment-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 82</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">current_attachment</span>
  <span class="ruby-identifier">attachment_versions</span>.<span class="ruby-identifier">find</span>(<span class="ruby-value">:first</span>)
<span class="ruby-keyword">end</span></pre>
          </div><!-- current_attachment-source -->
          
        </div>

        

        
      </div><!-- current_attachment-method -->

    
      <div id="method-i-editable-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">editable?</span><span
            class="method-args">(current_user)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="editable-3F-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 208</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">editable?</span>(<span class="ruby-identifier">current_user</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">is_team_deliverable?</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">team</span>.<span class="ruby-identifier">is_user_on_team?</span>(<span class="ruby-identifier">current_user</span>)
      <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_staff?</span>)<span class="ruby-operator">||</span>(<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_admin?</span>)
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">is_team_deliverable?</span>
    <span class="ruby-keyword">unless</span> <span class="ruby-identifier">current_user</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">creator</span>
      <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_staff?</span>)<span class="ruby-operator">||</span>(<span class="ruby-identifier">current_user</span>.<span class="ruby-identifier">is_admin?</span>)
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- editable-3F-source -->
          
        </div>

        

        
      </div><!-- editable-3F-method -->

    
      <div id="method-i-has_feedback-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">has_feedback?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="has_feedback-3F-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 152</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">has_feedback?</span>
  <span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">feedback_comment</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-keyword">or</span> <span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">feedback_file_name</span>.<span class="ruby-identifier">blank?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- has_feedback-3F-source -->
          
        </div>

        

        
      </div><!-- has_feedback-3F-method -->

    
      <div id="method-i-is_team_deliverable-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">is_team_deliverable?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="is_team_deliverable-3F-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">is_team_deliverable?</span>
  <span class="ruby-identifier">team</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- is_team_deliverable-3F-source -->
          
        </div>

        

        
      </div><!-- is_team_deliverable-3F-method -->

    
      <div id="method-i-owner_email" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">owner_email</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="owner_email-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 94</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">owner_email</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">is_team_deliverable?</span>
    <span class="ruby-identifier">team</span>.<span class="ruby-identifier">email</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">creator</span>.<span class="ruby-identifier">email</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- owner_email-source -->
          
        </div>

        

        
      </div><!-- owner_email-method -->

    
      <div id="method-i-owner_name" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">owner_name</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="owner_name-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 86</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">owner_name</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">is_team_deliverable?</span>
    <span class="ruby-identifier">team</span>.<span class="ruby-identifier">name</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">creator</span>.<span class="ruby-identifier">human_name</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- owner_name-source -->
          
        </div>

        

        
      </div><!-- owner_name-method -->

    
      <div id="method-i-populate_status" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">populate_status</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="populate_status-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 156</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">populate_status</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">status</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">status</span> = <span class="ruby-string">&quot;Ungraded&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- populate_status-source -->
          
        </div>

        

        
      </div><!-- populate_status-method -->

    
      <div id="method-i-send_deliverable_feedback_email" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">send_deliverable_feedback_email</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="send_deliverable_feedback_email-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 190</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">send_deliverable_feedback_email</span>(<span class="ruby-identifier">url</span>)
  <span class="ruby-identifier">mail_to</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">owner_email</span>

  <span class="ruby-identifier">message</span> = <span class="ruby-string">&quot;Feedback has been submitted for &quot;</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">task_number</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">and</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">task_number</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-identifier">message</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot;task &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">task_number</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; of &quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">message</span> <span class="ruby-operator">+=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">course</span>.<span class="ruby-identifier">name</span>

  <span class="ruby-identifier">options</span> = {<span class="ruby-value">:to</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">mail_to</span>,
             <span class="ruby-value">:subject</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Feedback for &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">course</span>.<span class="ruby-identifier">name</span>,
             <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">message</span>,
             <span class="ruby-value">:url_label</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;View this deliverable&quot;</span>,
             <span class="ruby-value">:url</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">url</span>
  }
  <span class="ruby-constant">GenericMailer</span>.<span class="ruby-identifier">email</span>(<span class="ruby-identifier">options</span>).<span class="ruby-identifier">deliver</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- send_deliverable_feedback_email-source -->
          
        </div>

        

        
      </div><!-- send_deliverable_feedback_email-method -->

    
      <div id="method-i-send_deliverable_upload_email" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">send_deliverable_upload_email</span><span
            class="method-args">(url)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="send_deliverable_upload_email-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 162</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">send_deliverable_upload_email</span>(<span class="ruby-identifier">url</span>)
  <span class="ruby-identifier">mail_to</span> = []
  <span class="ruby-keyword">unless</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">team</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">team</span>.<span class="ruby-identifier">primary_faculty</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">mail_to</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">team</span>.<span class="ruby-identifier">primary_faculty</span>.<span class="ruby-identifier">email</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">unless</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">team</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">team</span>.<span class="ruby-identifier">secondary_faculty</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">mail_to</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">team</span>.<span class="ruby-identifier">secondary_faculty</span>.<span class="ruby-identifier">email</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">mail_to</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">message</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">owner_name</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; has submitted a deliverable for &quot;</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword">self</span>.<span class="ruby-identifier">task_number</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-keyword">and</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">task_number</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-identifier">message</span> <span class="ruby-operator">+=</span> <span class="ruby-string">&quot;task &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">task_number</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; of &quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">message</span> <span class="ruby-operator">+=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">course</span>.<span class="ruby-identifier">name</span>

  <span class="ruby-identifier">options</span> = {<span class="ruby-value">:to</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">mail_to</span>,
             <span class="ruby-value">:subject</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;Deliverable submitted for &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">course</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">+</span> <span class="ruby-string">&quot; by &quot;</span> <span class="ruby-operator">+</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">owner_name</span>,
             <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">message</span>,
             <span class="ruby-value">:url_label</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;View this deliverable&quot;</span>,
             <span class="ruby-value">:url</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">url</span>
  }
  <span class="ruby-constant">GenericMailer</span>.<span class="ruby-identifier">email</span>(<span class="ruby-identifier">options</span>).<span class="ruby-identifier">deliver</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- send_deliverable_upload_email-source -->
          
        </div>

        

        
      </div><!-- send_deliverable_upload_email-method -->

    
      <div id="method-i-task_number" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">task_number</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="task_number-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 61</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">task_number</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">assignment</span>.<span class="ruby-identifier">task_number</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- task_number-source -->
          
        </div>

        

        
      </div><!-- task_number-method -->

    
      <div id="method-i-unique_course_task_owner-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">unique_course_task_owner?</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="unique_course_task_owner-3F-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 65</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">unique_course_task_owner?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">is_team_deliverable?</span>
    <span class="ruby-identifier">duplicate</span> = <span class="ruby-constant">Deliverable</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:assignment_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">assignment_id</span>, <span class="ruby-value">:team_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">team_id</span>).<span class="ruby-identifier">first</span>
    <span class="ruby-identifier">type</span> = <span class="ruby-string">&quot;team&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">duplicate</span> = <span class="ruby-constant">Deliverable</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:assignment_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">assignment_id</span>, <span class="ruby-value">:team_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">:creator_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">creator_id</span>).<span class="ruby-identifier">first</span>
    <span class="ruby-identifier">type</span> = <span class="ruby-string">&quot;individual&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">duplicate</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">duplicate</span>.<span class="ruby-identifier">id</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">id</span>
    <span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-value">:base</span>, <span class="ruby-node">&quot;Can't create another #{type} deliverable for the same assignment. Please edit the existing one.&quot;</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- unique_course_task_owner-3F-source -->
          
        </div>

        

        
      </div><!-- unique_course_task_owner-3F-method -->

    
      <div id="method-i-update_team" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">update_team</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="update_team-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 226</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">update_team</span>
  <span class="ruby-comment"># Look up the team this user is on if it is a team deliverable</span>
  <span class="ruby-constant">Team</span>.<span class="ruby-identifier">where</span>(<span class="ruby-value">:course_id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">course_id</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">team</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">answer</span> = <span class="ruby-identifier">team</span>.<span class="ruby-identifier">members</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">creator</span>)
    <span class="ruby-keyword">self</span>.<span class="ruby-identifier">team</span> = <span class="ruby-identifier">team</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">team</span>.<span class="ruby-identifier">members</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-keyword">self</span>.<span class="ruby-identifier">creator</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- update_team-source -->
          
        </div>

        

        
      </div><!-- update_team-method -->

    
    </section><!-- public-instance-method-details -->
  
     <section id="protected-instance-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Protected Instance Methods</h3>

    
      <div id="method-i-sanitize_data" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sanitize_data</span><span
            class="method-args">()</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          
          

          
          <div class="method-source-code" id="sanitize_data-source">
            <pre><span class="ruby-comment"># File app/models/deliverable.rb, line 235</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sanitize_data</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">name</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">titleize</span> <span class="ruby-keyword">unless</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">blank?</span>
<span class="ruby-keyword">end</span></pre>
          </div><!-- sanitize_data-source -->
          
        </div>

        

        
      </div><!-- sanitize_data-method -->

    
    </section><!-- protected-instance-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.10.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

