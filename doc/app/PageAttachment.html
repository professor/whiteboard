<!DOCTYPE html>

<html>
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

<title>Class: PageAttachment</title>

<link type="text/css" media="screen" href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script type="text/javascript" charset="utf-8" src="./js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/navigation.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search_index.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/search.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/searcher.js"></script>
<script type="text/javascript" charset="utf-8" src="./js/darkfish.js"></script>


<body id="top" class="class">
<nav id="metadata">
  <nav id="home-section" class="section">
  <h3 class="section-header">
    <a href="./index.html">Home</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </h3>
</nav>


  <nav id="search-section" class="section project-section" class="initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <h3 class="section-header">
      <input type="text" name="search" placeholder="Search" id="search-field"
             title="Type to search, Up and Down to navigate, Enter to load">
    </h3>
  </form>

  <ul id="search-results" class="initially-hidden"></ul>
</nav>


  <div id="file-metadata">
    <nav id="file-list-section" class="section">
  <h3 class="section-header">Defined In</h3>
  <ul>
    <li>app/models/page_attachment.rb
  </ul>
</nav>

    
  </div>

  <div id="class-metadata">
    
    <nav id="parent-class-section" class="section">
  <h3 class="section-header">Parent</h3>
  
  <p class="link">ActiveRecord::Base
  
</nav>

    
    <!-- Method Quickref -->
<nav id="method-list-section" class="section">
  <h3 class="section-header">Methods</h3>

  <ul class="link-list">
    
    <li><a href="#method-c-reposition">::reposition</a>
    
  </ul>
</nav>

  </div>

  <div id="project-metadata">
    
    <nav id="classindex-section" class="section project-section">
  <h3 class="section-header">Class and Module Index</h3>

  <ul class="link-list">
  
    <li><a href="./Ability.html">Ability</a>
  
    <li><a href="./AcademicCalendar.html">AcademicCalendar</a>
  
    <li><a href="./Assignment.html">Assignment</a>
  
    <li><a href="./Course.html">Course</a>
  
    <li><a href="./CourseNumber.html">CourseNumber</a>
  
    <li><a href="./DelayedSystemJob.html">DelayedSystemJob</a>
  
    <li><a href="./Deliverable.html">Deliverable</a>
  
    <li><a href="./DeliverableAttachment.html">DeliverableAttachment</a>
  
    <li><a href="./EffortLog.html">EffortLog</a>
  
    <li><a href="./EffortLogLineItem.html">EffortLogLineItem</a>
  
    <li><a href="./FacultyAssignment.html">FacultyAssignment</a>
  
    <li><a href="./GradingRange.html">GradingRange</a>
  
    <li><a href="./Page.html">Page</a>
  
    <li><a href="./PageAttachment.html">PageAttachment</a>
  
    <li><a href="./PageComment.html">PageComment</a>
  
    <li><a href="./PageCommentType.html">PageCommentType</a>
  
    <li><a href="./PeerEvaluationLearningObjective.html">PeerEvaluationLearningObjective</a>
  
    <li><a href="./PeerEvaluationReport.html">PeerEvaluationReport</a>
  
    <li><a href="./PeerEvaluationReview.html">PeerEvaluationReview</a>
  
    <li><a href="./Person.html">Person</a>
  
    <li><a href="./Presentation.html">Presentation</a>
  
    <li><a href="./PresentationFeedback.html">PresentationFeedback</a>
  
    <li><a href="./PresentationFeedbackAnswer.html">PresentationFeedbackAnswer</a>
  
    <li><a href="./PresentationQuestion.html">PresentationQuestion</a>
  
    <li><a href="./RegisteredCourse.html">RegisteredCourse</a>
  
    <li><a href="./Registration.html">Registration</a>
  
    <li><a href="./RssFeed.html">RssFeed</a>
  
    <li><a href="./ScottyDogSaying.html">ScottyDogSaying</a>
  
    <li><a href="./SponsoredProject.html">SponsoredProject</a>
  
    <li><a href="./SponsoredProjectAllocation.html">SponsoredProjectAllocation</a>
  
    <li><a href="./SponsoredProjectEffort.html">SponsoredProjectEffort</a>
  
    <li><a href="./SponsoredProjectSponsor.html">SponsoredProjectSponsor</a>
  
    <li><a href="./StrengthTheme.html">StrengthTheme</a>
  
    <li><a href="./Suggestion.html">Suggestion</a>
  
    <li><a href="./TaskType.html">TaskType</a>
  
    <li><a href="./Team.html">Team</a>
  
    <li><a href="./TeamAssignment.html">TeamAssignment</a>
  
    <li><a href="./User.html">User</a>
  
    <li><a href="./UserPreference.html">UserPreference</a>
  
  </ul>
</nav>

  </div>
</nav>

<div id="documentation">
  <h1 class="class">class PageAttachment</h1>

  <div id="description" class="description">
    
<p>Any user who can edit a <a href="classes/Page.html">Page</a> can also
upload attachments to that page. (Note: in this system a <a
href="Page.html">Page</a> is the CMS pages that represent curriculum
materials. A user can not upload an attachment to a team or a person page
through this code.)</p>

<p>The attachments are stored on Amazon S3. S3 allows us to revision all
documents. All old versions are still stored on the filesystem even though
the user can only actively access the latest one.</p>

<p>When uploading a file, the user is asked for a “readable name” for the
file: a label for the link to the file.</p>

<p>After uploading a file, the file’s “readable name” can be updated or the
file can be replaced. If the user replaces the an existing file (e.g.
‘ppm_week1.ppt’) with a different file name (e.g. ‘ppm_week1_ts.ppt’) then
a warning appears. Any user who tries to access the original file name will
not be able to do so. Under normal workflow, this isn’t a big deal. It is
possible for the user to create a link on the page to the old file and
system will not automatically update it.</p>

<p>The system records who uploads and replaces the file and when this happens,
and versions this information.</p>

<p>AWS S3 allows</p>

  </div><!-- description -->

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    

    

    <!-- Methods -->
    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section section">
      <h3 class="section-header">Public Class Methods</h3>

    
      <div id="method-c-reposition" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">reposition</span><span
            class="method-args">(ids)</span>
          <span class="method-click-advice">click to toggle source</span>
        </div>
        

        <div class="method-description">
          
          <p>Re-position: change the sequence of attachments for a given page</p>
          

          
          <div class="method-source-code" id="reposition-source">
            <pre><span class="ruby-comment"># File app/models/page_attachment.rb, line 40</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">reposition</span>(<span class="ruby-identifier">ids</span>)
  <span class="ruby-identifier">update_all</span>([<span class="ruby-string">&quot;position = STRPOS(?, ','||id||',')&quot;</span>, <span class="ruby-node">&quot;,#{ids.join(',')},&quot;</span>], {<span class="ruby-value">:id</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ids</span>})
<span class="ruby-keyword">end</span></pre>
          </div><!-- reposition-source -->
          
        </div>

        

        
      </div><!-- reposition-method -->

    
    </section><!-- public-class-method-details -->
  
  </section><!-- 5Buntitled-5D -->

</div><!-- documentation -->


<footer id="validator-badges">
  <p><a href="http://validator.w3.org/check/referer">[Validate]</a>
  <p>Generated by <a href="https://github.com/rdoc/rdoc">RDoc</a> 3.10.
  <p>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish Rdoc Generator</a> 3.
</footer>

