<%= form_for([@course, @team]) do |f| %>
  <% if @team.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@team.errors.count, "error") %> prohibited this team from being saved:</h2>

      <ul>
      <% @team.errors.full_messages.each do |msg| %>
        <li><%= msg %></li>
      <% end %>
      </ul>
    </div>
  <% end %> 
  <div class="rounded staff">
<%= image_tag("/images/professor.jpg", :size => "50x50", :border=>"0", :alt=>"These fields can be edited by a faculty role") %>
  <span class="instructions">These fields can be edited by faculty.</span>
  <% if !(current_user.is_admin? || current_user.is_staff?)  %>
  <%= render :partial => 'show_faculty_fields' %>
  <% else %>

  <p>
    <%= f.label :name %><br />
    <%= f.text_field :name, :size => 40 %>
  </p>


  <p>
    <%= f.label :section %><br />
    <%= f.text_field :section  %><br />
  </p>

  <table><tbody>
    <tr><td><%= f.label :primary_faculty_id, "Primary faculty" %><br /></td><td>&nbsp;</td><td>&nbsp;</td>
  <td>Alter label for primary faculty (ie Coach, VP of Engineering)</td></tr>
  <tr><td><%= f.collection_select(:primary_faculty_id, @faculty, :id, :human_name, :include_blank => true) %></td><td>&nbsp;</td><td>&nbsp;</td>
  <td><%= text_field_tag :primary_faculty_label, @course.primary_faculty_label, :size => 20 %> <i>(affects all teams in this course)</i></td></tr>
    <tr><td><%= f.label :secondary_faculty_id, "Secondary faculty" %><br /></td><td>&nbsp;</td><td>&nbsp;</td>
  <td>Alter label for secondary faculty (ie Coach, VP of Engineering)</td></tr>
  <tr><td><%= f.collection_select(:secondary_faculty_id, @faculty, :id, :human_name, :include_blank => true) %></td><td>&nbsp;</td><td>&nbsp;</td>
  <td><%= text_field_tag :secondary_faculty_label, @course.secondary_faculty_label, :size => 20 %> <i>(affects all teams in this course)</i></td></tr>
</tbody></table>
  <br />

        <div id="people_in_a_collection">
          <p>Team members</p>
         <%= render :partial => '/people/person_in_a_collection', :collection =>@team.people, :locals => { :collection_form => f , :member_label => "Person"}   %>
       </div>

       <div class="formItem indented"><p><%= link_to "Add a team member", "#", :id => "add_person" %></p></div>


<%# content_for :javascript do %>
   <%# javascript_tag do %>
<script type="text/javascript">
	$(function() {
		$("#add_person").click(function() {
           $("#people_in_a_collection").append("<%= escape_javascript(render(:partial => '/people/person_in_a_collection', :object => Person.new, :locals => { :member_label => "Person"} )) %>");
        });

 	});
</script>
   <%# end %>
<%# end %>        

  <% end %>
  </div>
  <div class="rounded admin">
  <%= image_tag("/images/admin.jpg", :size => "50x50", :border=>"0", :alt=>"These fields can be edited by an admin role") %>
  <span class="instructions">These fields can be edited by admin.</span>
  <% if !(current_user.is_admin?)  %>
  <%= render :partial => 'show_admin_fields' %>
  <% else %>
  <p>
    <%= f.label :twiki_space, "TWiki space" %><br />
    <%= f.text_field :twiki_space, :size => 90 %><br />
    <span class="help_text">Email twiki@sv.cmu.edu once all of your students have selected team names. </span>
  </p>
  <p>
    <%= f.label :tigris_space %><br />
    <%= f.text_field :tigris_space, :size => 90 %><br />
    <span class="help_text">Email todd.sedano@sv.cmu.edu if you want tigris.org project(s) created for your course, please indicate if you need one project per team or one project for the whole course</span>
  </p>
  <% end %>
  </div>
  <div class="rounded system">
  <p>
    Email (autogenerated)<br />
    <%= f.text_field :email, :size=>90, :readonly => true %>
    <span class="help_text">Distribution lists for each team are created by the system once a team name is provided.</span>
  </p>
  </div>
  <br />
  <p>
    <%= f.submit button_name %>
  </p>
<% end %>